{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Huawe\\u0131\\\\VS_CODE\\\\film-dizi-oneri-sitesi-main\\\\film-dizi-oneri-sitesi-main\\\\Frontend\\\\src\\\\components\\\\ChooseFilms.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChooseFilms = () => {\n  _s();\n  const [films, setFilms] = useState([]);\n  const [selected, setSelected] = useState([]);\n  const navigate = useNavigate();\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_API_URL}/films`).then(res => res.json()).then(data => setFilms(data)).catch(err => console.error(\"Film Ã§ekme hatasÄ±:\", err));\n  }, []);\n  const toggleSelect = film => {\n    if (selected.find(f => f._id === film._id)) {\n      setSelected(selected.filter(f => f._id !== film._id));\n    } else {\n      if (selected.length < 3) {\n        setSelected([...selected, film]);\n      } else {\n        alert(\"Sadece 3 film seÃ§ebilirsiniz.\");\n      }\n    }\n  };\n  const calculateAverages = () => {\n    const keys = [\"romance\", \"action\", \"adventure\", \"horror\", \"thriller\", \"sciFi\", \"imdb\"];\n    const avg = {};\n    keys.forEach(key => {\n      const total = selected.reduce((sum, film) => sum + (film[key] || 0), 0);\n      avg[key] = parseFloat((total / selected.length).toFixed(2));\n    });\n    return avg;\n  };\n  const handleSubmit = async () => {\n    if (selected.length !== 3) {\n      alert(\"LÃ¼tfen 3 film seÃ§in.\");\n      return;\n    }\n    const preference = calculateAverages();\n    const token = localStorage.getItem(\"token\");\n\n    // ðŸŽ¯ score: burada hepsine 10 puan verdik, istersen kullanÄ±cÄ±dan sorabilirsin\n    const ratings = selected.map(film => ({\n      movieId: film._id,\n      score: 10\n    }));\n    try {\n      // ðŸ‘¤ KullanÄ±cÄ± bilgisini al\n      const userRes = await fetch(`${process.env.REACT_APP_API_URL}/me`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const user = await userRes.json();\n\n      // ðŸŽ¯ Favori filmleri gÃ¶nder (ratings olarak!)\n      const favRes = await fetch(`${process.env.REACT_APP_API_URL}/users/${user._id}/favorites`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          ratings\n        })\n      });\n      const favResult = await favRes.json();\n      console.log(\"âœ… Favoriler:\", favResult);\n\n      // ðŸŽ¯ Tercih verilerini gÃ¶nder\n      const preferenceRes = await fetch(`${process.env.REACT_APP_API_URL}/users/${user._id}/preferences`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          preference\n        })\n      });\n      const prefResult = await preferenceRes.json();\n      console.log(\"âœ… Tercihler:\", prefResult);\n\n      // ðŸš€ Anasayfaya yÃ¶nlendir\n      navigate(\"/home\");\n    } catch (err) {\n      console.error(\"ðŸ”¥ Hata:\", err);\n      alert(\"Bir hata oluÅŸtu.\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: \"2rem\",\n      textAlign: \"center\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\uD83C\\uDFAF 3 favori filmini se\\xE7\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        flexWrap: \"wrap\",\n        justifyContent: \"center\",\n        gap: \"1rem\"\n      },\n      children: films.map(film => /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: () => toggleSelect(film),\n        style: {\n          width: \"200px\",\n          border: selected.find(f => f._id === film._id) ? \"3px solid #00ffff\" : \"1px solid #ccc\",\n          borderRadius: \"8px\",\n          padding: \"1rem\",\n          cursor: \"pointer\",\n          backgroundColor: \"#fff\",\n          boxShadow: \"0 2px 6px rgba(0,0,0,0.1)\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: film.photo,\n          alt: film.name,\n          style: {\n            width: \"100%\",\n            height: \"260px\",\n            objectFit: \"cover\",\n            borderRadius: \"6px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n          style: {\n            marginTop: \"0.5rem\"\n          },\n          children: film.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 13\n        }, this)]\n      }, film._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSubmit,\n      style: {\n        marginTop: \"2rem\",\n        padding: \"0.75rem 2rem\",\n        fontSize: \"1rem\",\n        cursor: \"pointer\"\n      },\n      children: \"Kaydet ve Devam Et\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this);\n};\n_s(ChooseFilms, \"nF+fqI+kusU/en05OpMqhLNEaSw=\", false, function () {\n  return [useNavigate];\n});\n_c = ChooseFilms;\nexport default ChooseFilms;\nvar _c;\n$RefreshReg$(_c, \"ChooseFilms\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jsxDEV","_jsxDEV","ChooseFilms","_s","films","setFilms","selected","setSelected","navigate","fetch","process","env","REACT_APP_API_URL","then","res","json","data","catch","err","console","error","toggleSelect","film","find","f","_id","filter","length","alert","calculateAverages","keys","avg","forEach","key","total","reduce","sum","parseFloat","toFixed","handleSubmit","preference","token","localStorage","getItem","ratings","map","movieId","score","userRes","headers","Authorization","user","favRes","method","body","JSON","stringify","favResult","log","preferenceRes","prefResult","style","padding","textAlign","children","fileName","_jsxFileName","lineNumber","columnNumber","display","flexWrap","justifyContent","gap","onClick","width","border","borderRadius","cursor","backgroundColor","boxShadow","src","photo","alt","name","height","objectFit","marginTop","fontSize","_c","$RefreshReg$"],"sources":["C:/Users/HuaweÄ±/VS_CODE/film-dizi-oneri-sitesi-main/film-dizi-oneri-sitesi-main/Frontend/src/components/ChooseFilms.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst ChooseFilms = () => {\n  const [films, setFilms] = useState([]);\n  const [selected, setSelected] = useState([]);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_API_URL}/films`)\n      .then((res) => res.json())\n      .then((data) => setFilms(data))\n      .catch((err) => console.error(\"Film Ã§ekme hatasÄ±:\", err));\n  }, []);\n\n  const toggleSelect = (film) => {\n    if (selected.find((f) => f._id === film._id)) {\n      setSelected(selected.filter((f) => f._id !== film._id));\n    } else {\n      if (selected.length < 3) {\n        setSelected([...selected, film]);\n      } else {\n        alert(\"Sadece 3 film seÃ§ebilirsiniz.\");\n      }\n    }\n  };\n\n  const calculateAverages = () => {\n    const keys = [\"romance\", \"action\", \"adventure\", \"horror\", \"thriller\", \"sciFi\", \"imdb\"];\n    const avg = {};\n    keys.forEach((key) => {\n      const total = selected.reduce((sum, film) => sum + (film[key] || 0), 0);\n      avg[key] = parseFloat((total / selected.length).toFixed(2));\n    });\n    return avg;\n  };\n\n  const handleSubmit = async () => {\n    if (selected.length !== 3) {\n      alert(\"LÃ¼tfen 3 film seÃ§in.\");\n      return;\n    }\n\n    const preference = calculateAverages();\n    const token = localStorage.getItem(\"token\");\n\n    // ðŸŽ¯ score: burada hepsine 10 puan verdik, istersen kullanÄ±cÄ±dan sorabilirsin\n    const ratings = selected.map((film) => ({\n      movieId: film._id,\n      score: 10\n    }));\n\n    try {\n      // ðŸ‘¤ KullanÄ±cÄ± bilgisini al\n      const userRes = await fetch(`${process.env.REACT_APP_API_URL}/me`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      const user = await userRes.json();\n\n      // ðŸŽ¯ Favori filmleri gÃ¶nder (ratings olarak!)\n      const favRes = await fetch(`${process.env.REACT_APP_API_URL}/users/${user._id}/favorites`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ ratings }),\n      });\n      const favResult = await favRes.json();\n      console.log(\"âœ… Favoriler:\", favResult);\n\n      // ðŸŽ¯ Tercih verilerini gÃ¶nder\n      const preferenceRes = await fetch(`${process.env.REACT_APP_API_URL}/users/${user._id}/preferences`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ preference }),\n      });\n      const prefResult = await preferenceRes.json();\n      console.log(\"âœ… Tercihler:\", prefResult);\n\n      // ðŸš€ Anasayfaya yÃ¶nlendir\n      navigate(\"/home\");\n    } catch (err) {\n      console.error(\"ðŸ”¥ Hata:\", err);\n      alert(\"Bir hata oluÅŸtu.\");\n    }\n  };\n\n  return (\n    <div style={{ padding: \"2rem\", textAlign: \"center\" }}>\n      <h2>ðŸŽ¯ 3 favori filmini seÃ§</h2>\n      <div style={{ display: \"flex\", flexWrap: \"wrap\", justifyContent: \"center\", gap: \"1rem\" }}>\n        {films.map((film) => (\n          <div\n            key={film._id}\n            onClick={() => toggleSelect(film)}\n            style={{\n              width: \"200px\",\n              border: selected.find((f) => f._id === film._id) ? \"3px solid #00ffff\" : \"1px solid #ccc\",\n              borderRadius: \"8px\",\n              padding: \"1rem\",\n              cursor: \"pointer\",\n              backgroundColor: \"#fff\",\n              boxShadow: \"0 2px 6px rgba(0,0,0,0.1)\"\n            }}\n          >\n            <img\n              src={film.photo}\n              alt={film.name}\n              style={{ width: \"100%\", height: \"260px\", objectFit: \"cover\", borderRadius: \"6px\" }}\n            />\n            <h4 style={{ marginTop: \"0.5rem\" }}>{film.name}</h4>\n          </div>\n        ))}\n      </div>\n      <button\n        onClick={handleSubmit}\n        style={{ marginTop: \"2rem\", padding: \"0.75rem 2rem\", fontSize: \"1rem\", cursor: \"pointer\" }}\n      >\n        Kaydet ve Devam Et\n      </button>\n    </div>\n  );\n};\n\nexport default ChooseFilms;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}