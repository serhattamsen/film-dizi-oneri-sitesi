{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Huawe\\u0131\\\\VS_CODE\\\\film-dizi-oneri-sitesi-main\\\\film-dizi-oneri-sitesi-main\\\\Frontend\\\\src\\\\components\\\\ChooseFilms.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChooseFilms = () => {\n  _s();\n  const [films, setFilms] = useState([]);\n  const [selected, setSelected] = useState([]);\n  const navigate = useNavigate();\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_API_URL}/films`).then(res => res.json()).then(data => setFilms(data)).catch(err => console.error(\"Film Ã§ekme hatasÄ±:\", err));\n  }, []);\n  const toggleSelect = film => {\n    setSelected(prevSelected => {\n      if (prevSelected.find(f => f._id === film._id)) {\n        return prevSelected.filter(f => f._id !== film._id);\n      } else {\n        if (prevSelected.length < 3) {\n          return [...prevSelected, film];\n        } else {\n          alert(\"Sadece 3 film seÃ§ebilirsiniz.\");\n          return prevSelected;\n        }\n      }\n    });\n  };\n  const calculateAverages = () => {\n    const keys = [\"romance\", \"action\", \"adventure\", \"horror\", \"thriller\", \"sciFi\", \"imdb\"];\n    const avg = {};\n    keys.forEach(key => {\n      const total = selected.reduce((sum, film) => sum + (film[key] || 0), 0);\n      avg[key] = parseFloat((total / selected.length).toFixed(2));\n    });\n    return avg;\n  };\n  const handleSubmit = async () => {\n    if (selected.length !== 3) {\n      alert(\"LÃ¼tfen 3 film seÃ§in.\");\n      return;\n    }\n    console.log(\"ðŸŸ¨ SeÃ§ilen film sayÄ±sÄ±:\", selected.length);\n    console.log(\"ðŸŽ¬ GÃ¶nderilecek filmler:\", selected);\n    const preference = calculateAverages();\n    const token = localStorage.getItem(\"token\");\n    const ratings = selected.map(film => ({\n      movieId: film._id,\n      score: 10\n    }));\n    try {\n      const userRes = await fetch(`${process.env.REACT_APP_API_URL}/me`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const user = await userRes.json();\n      const favRes = await fetch(`${process.env.REACT_APP_API_URL}/users/${user._id}/favorites`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          ratings\n        })\n      });\n      const favResult = await favRes.json();\n      console.log(\"âœ… Favoriler:\", favResult);\n      const preferenceRes = await fetch(`${process.env.REACT_APP_API_URL}/users/${user._id}/preferences`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          preference\n        })\n      });\n      const prefResult = await preferenceRes.json();\n      console.log(\"âœ… Tercihler:\", prefResult);\n      navigate(\"/home\");\n    } catch (err) {\n      console.error(\"ðŸ”¥ Hata:\", err);\n      alert(\"Bir hata oluÅŸtu.\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: \"2rem\",\n      textAlign: \"center\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\uD83C\\uDFAF 3 favori filmini se\\xE7\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        flexWrap: \"wrap\",\n        justifyContent: \"center\",\n        gap: \"1rem\"\n      },\n      children: films.map(film => /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: () => toggleSelect(film),\n        style: {\n          width: \"200px\",\n          border: selected.find(f => f._id === film._id) ? \"3px solid #00ffff\" : \"1px solid #ccc\",\n          borderRadius: \"8px\",\n          padding: \"1rem\",\n          cursor: \"pointer\",\n          backgroundColor: \"#fff\",\n          boxShadow: \"0 2px 6px rgba(0,0,0,0.1)\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: film.photo,\n          alt: film.name,\n          style: {\n            width: \"100%\",\n            height: \"260px\",\n            objectFit: \"cover\",\n            borderRadius: \"6px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n          style: {\n            marginTop: \"0.5rem\"\n          },\n          children: film.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 13\n        }, this)]\n      }, film._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSubmit,\n      style: {\n        marginTop: \"2rem\",\n        padding: \"0.75rem 2rem\",\n        fontSize: \"1rem\",\n        cursor: \"pointer\"\n      },\n      children: \"Kaydet ve Devam Et\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n};\n_s(ChooseFilms, \"nF+fqI+kusU/en05OpMqhLNEaSw=\", false, function () {\n  return [useNavigate];\n});\n_c = ChooseFilms;\nexport default ChooseFilms;\nvar _c;\n$RefreshReg$(_c, \"ChooseFilms\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jsxDEV","_jsxDEV","ChooseFilms","_s","films","setFilms","selected","setSelected","navigate","fetch","process","env","REACT_APP_API_URL","then","res","json","data","catch","err","console","error","toggleSelect","film","prevSelected","find","f","_id","filter","length","alert","calculateAverages","keys","avg","forEach","key","total","reduce","sum","parseFloat","toFixed","handleSubmit","log","preference","token","localStorage","getItem","ratings","map","movieId","score","userRes","headers","Authorization","user","favRes","method","body","JSON","stringify","favResult","preferenceRes","prefResult","style","padding","textAlign","children","fileName","_jsxFileName","lineNumber","columnNumber","display","flexWrap","justifyContent","gap","onClick","width","border","borderRadius","cursor","backgroundColor","boxShadow","src","photo","alt","name","height","objectFit","marginTop","fontSize","_c","$RefreshReg$"],"sources":["C:/Users/HuaweÄ±/VS_CODE/film-dizi-oneri-sitesi-main/film-dizi-oneri-sitesi-main/Frontend/src/components/ChooseFilms.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst ChooseFilms = () => {\n  const [films, setFilms] = useState([]);\n  const [selected, setSelected] = useState([]);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_API_URL}/films`)\n      .then((res) => res.json())\n      .then((data) => setFilms(data))\n      .catch((err) => console.error(\"Film Ã§ekme hatasÄ±:\", err));\n  }, []);\n\n  const toggleSelect = (film) => {\n    setSelected((prevSelected) => {\n      if (prevSelected.find((f) => f._id === film._id)) {\n        return prevSelected.filter((f) => f._id !== film._id);\n      } else {\n        if (prevSelected.length < 3) {\n          return [...prevSelected, film];\n        } else {\n          alert(\"Sadece 3 film seÃ§ebilirsiniz.\");\n          return prevSelected;\n        }\n      }\n    });\n  };\n\n  const calculateAverages = () => {\n    const keys = [\"romance\", \"action\", \"adventure\", \"horror\", \"thriller\", \"sciFi\", \"imdb\"];\n    const avg = {};\n    keys.forEach((key) => {\n      const total = selected.reduce((sum, film) => sum + (film[key] || 0), 0);\n      avg[key] = parseFloat((total / selected.length).toFixed(2));\n    });\n    return avg;\n  };\n\n  const handleSubmit = async () => {\n    if (selected.length !== 3) {\n      alert(\"LÃ¼tfen 3 film seÃ§in.\");\n      return;\n    }\n\n    console.log(\"ðŸŸ¨ SeÃ§ilen film sayÄ±sÄ±:\", selected.length);\n    console.log(\"ðŸŽ¬ GÃ¶nderilecek filmler:\", selected);\n\n    const preference = calculateAverages();\n    const token = localStorage.getItem(\"token\");\n\n    const ratings = selected.map((film) => ({\n      movieId: film._id,\n      score: 10\n    }));\n\n    try {\n      const userRes = await fetch(`${process.env.REACT_APP_API_URL}/me`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      const user = await userRes.json();\n\n      const favRes = await fetch(`${process.env.REACT_APP_API_URL}/users/${user._id}/favorites`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ ratings }),\n      });\n\n      const favResult = await favRes.json();\n      console.log(\"âœ… Favoriler:\", favResult);\n\n      const preferenceRes = await fetch(`${process.env.REACT_APP_API_URL}/users/${user._id}/preferences`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ preference }),\n      });\n\n      const prefResult = await preferenceRes.json();\n      console.log(\"âœ… Tercihler:\", prefResult);\n\n      navigate(\"/home\");\n    } catch (err) {\n      console.error(\"ðŸ”¥ Hata:\", err);\n      alert(\"Bir hata oluÅŸtu.\");\n    }\n  };\n\n  return (\n    <div style={{ padding: \"2rem\", textAlign: \"center\" }}>\n      <h2>ðŸŽ¯ 3 favori filmini seÃ§</h2>\n      <div style={{ display: \"flex\", flexWrap: \"wrap\", justifyContent: \"center\", gap: \"1rem\" }}>\n        {films.map((film) => (\n          <div\n            key={film._id}\n            onClick={() => toggleSelect(film)}\n            style={{\n              width: \"200px\",\n              border: selected.find((f) => f._id === film._id) ? \"3px solid #00ffff\" : \"1px solid #ccc\",\n              borderRadius: \"8px\",\n              padding: \"1rem\",\n              cursor: \"pointer\",\n              backgroundColor: \"#fff\",\n              boxShadow: \"0 2px 6px rgba(0,0,0,0.1)\"\n            }}\n          >\n            <img\n              src={film.photo}\n              alt={film.name}\n              style={{ width: \"100%\", height: \"260px\", objectFit: \"cover\", borderRadius: \"6px\" }}\n            />\n            <h4 style={{ marginTop: \"0.5rem\" }}>{film.name}</h4>\n          </div>\n        ))}\n      </div>\n      <button\n        onClick={handleSubmit}\n        style={{ marginTop: \"2rem\", padding: \"0.75rem 2rem\", fontSize: \"1rem\", cursor: \"pointer\" }}\n      >\n        Kaydet ve Devam Et\n      </button>\n    </div>\n  );\n};\n\nexport default ChooseFilms;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}